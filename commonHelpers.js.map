{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst URL_SEARCH_IMAGES = 'https://pixabay.com/api/';\nconst API_KEY = '43910002-4f8293575df59775d1c0606c1';\n\nexport async function fetchImages(query, page, perPage) {\n  try {\n    const response = await axios.get(URL_SEARCH_IMAGES, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        lang: 'en',\n        page: page,\n        per_page: perPage,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error(error);\n    throw error;\n  }\n}\n","export function markUpSearchImg(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `\n          <li class=\"js-list\">\n              <a href=\"${largeImageURL}\"><img class=\"js-image\" src=\"${webformatURL}\" alt=\"${tags}\" /></a>\n              <ul class=\"js-dates\">\n                  <li class=\"js-likes\">Likes: ${likes}</li>\n                  <li class=\"js-views\">Views: ${views}</li>\n                  <li class=\"js-comments\">Comments: ${comments}</li>\n                  <li class=\"js-downloads\">Downloads: ${downloads}</li>\n              </ul>\n          </li>\n      `\n    )\n    .join('');\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport { markUpSearchImg } from './js/render-functions';\n\n\nconst refs = {\n  formSearch: document.getElementById('formSearch'),\n  inputSearch: document.getElementById('inputSearch'),\n  btnSearch: document.getElementById('btnSearch'),\n  galleryList: document.querySelector('.js-ImagesCart'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.getElementById('btnLoadMore'),\n  loaderNoMore: document.querySelector('.loaderNoMore'),\n};\n\nrefs.formSearch.addEventListener('submit', onBtnSearch);\nrefs.btnLoadMore.addEventListener('click', loadImgMore);\n\nconst lightbox = new SimpleLightbox('.js-ImagesCart a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet inputValue = '';\nlet totalLoadedImages = 0;\nlet totalHits = 0;\n\nfunction checkInput() {\n  const input = refs.inputSearch.value.trim();\n  if (input === '') {\n    iziToast.show({\n      message: 'Please, enter a search query!',\n      timeout: 5000,\n      backgroundColor: '#EF4040',\n    });\n    return false;\n  }\n  return true;\n}\n\nexport async function onBtnSearch(event) {\n  event.preventDefault();\n\n  if (!checkInput()) {\n    return;\n  }\n\n  inputValue = refs.inputSearch.value.trim();\n  refs.galleryList.innerHTML = '';\n  refs.loader.style.display = 'block';\n  refs.loaderNoMore.style.display = 'none';\n  refs.btnLoadMore.style.display = 'none';\n  totalLoadedImages = 0; // Скидаємо лічильник завантажених зображень\n  page = 1; // Починаємо з першої сторінки\n\n  await getImages(15); // Завантажуємо першу сторінку зображень\n}\n\nasync function getImages(perPage) {\n  try {\n    const data = await fetchImages(inputValue, page, perPage);\n\n    if (data.hits.length === 0) {\n      iziToast.show({\n        message: 'Sorry, there are no images matching your search query. Please, try again!',\n        timeout: 5000,\n        backgroundColor: '#EF4040',\n      });\n      refs.btnLoadMore.style.display = 'none';\n      refs.loaderNoMore.style.display = 'block';\n    } else {\n      totalLoadedImages += data.hits.length;\n      totalHits = data.totalHits;\n\n      if (page === 1) {\n        refs.galleryList.innerHTML = markUpSearchImg(data.hits);\n      } else {\n        refs.galleryList.insertAdjacentHTML('beforeend', markUpSearchImg(data.hits));\n        // Прокрутка сторінки після завантаження нової групи зображень\n        smoothScroll();\n      }\n      lightbox.refresh(); // Оновлення lightbox після завантаження нових зображень\n\n      // Якщо немає більше результатів для завантаження, приховуємо кнопку \"Load More\" та показуємо повідомлення\n      if (totalLoadedImages >= totalHits) {\n        refs.btnLoadMore.style.display = 'none';\n        refs.loaderNoMore.style.display = 'block';\n        iziToast.show({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          timeout: 5000,\n          backgroundColor: '#EF4040',\n        });\n      } else {\n        refs.btnLoadMore.style.display = 'block';\n      }\n    }\n    return data.hits;\n  } catch (error) {\n    console.error(error);\n    iziToast.show({\n      message: 'Something went wrong. Please, try again later.',\n      timeout: 5000,\n      backgroundColor: '#EF4040',\n    });\n  } finally {\n    refs.loader.style.display = 'none';\n    refs.formSearch.reset();\n  }\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document.querySelector('.js-list').getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function loadImgMore() {\n  page += 1;\n\n  try {\n    const data = await getImages(15); // Завантажуємо 15 зображень при кожному натисканні \"Load More\"\n    refs.galleryList.insertAdjacentHTML('beforeend', markUpSearchImg(data));\n    lightbox.refresh(); // Оновлення lightbox після завантаження нових зображень\n    // Прокрутка сторінки після завантаження нової групи зображень\n    smoothScroll();\n  } catch (error) {\n    console.error(error.message);\n    iziToast.show({\n      message: 'Something went wrong. Please, try again later.',\n      timeout: 5000,\n      backgroundColor: '#EF4040',\n    });\n  }\n}\n"],"names":["URL_SEARCH_IMAGES","API_KEY","fetchImages","query","page","perPage","axios","error","markUpSearchImg","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","onBtnSearch","loadImgMore","lightbox","SimpleLightbox","inputValue","totalLoadedImages","totalHits","checkInput","iziToast","event","getImages","data","smoothScroll","cardHeight"],"mappings":"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"}